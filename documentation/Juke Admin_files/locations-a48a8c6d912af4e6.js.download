(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[673],{18872:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/locations",function(){return n(42010)}])},42010:function(e,t,n){"use strict";n.r(t);var a=n(54011),i=n(14134),o=n(33510),s=n(9551),l=n(89663),r=n(77423),c=n(66586),u=n(44922),d=n(3335),p=n(15281),g=n.n(p),h=n(97458),f=n(1350),v=n(78828),L=n(66220),m=n(64533),S=n(39378),b=n(78778),y=n(40645),C=n(82014),T=n(46623),_=n(65412),N=n(94796),x=_.l6.LOCATION_LIST,M=m.L_.buildSelectOptions(N.Xc,N.pm),E=function(e){(0,r.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r,d;(0,o.Z)(this,n),(r=t.call(this,e)).getLocationList=function(){var e=r.props.onErrorCatch,t=r.state,n=t.pageNumber,o=t.pageSize,s=t.fields,l=s.type,c=s.name,u=s.sort;r.setState({isLoading:!0});var d=f.QM.setStringValueToCache(c),p=f.QM.setMultiselectValuesToCache(l),h=f.QM.setSelectValueToCache(u),v={pageNumber:n,pageSize:o,types:p,name:d,sortBy:h};(0,m.bj)(x,{types:p,name:d,pageNumber:n,pageSize:o,sort:h});var S=(0,a.Z)(r);L.b$.getAllLocations({queryParameters:v,signal:r.signal}).then((function(e){var t=m.sm.getResultsFromResponse(e),n=m.sm.getPaginationFromResponse(e);if(0===t.length)r.setState({isLoading:!1,locations:[]});else{var a=n.pageNumber,i=n.totalPages;r.setState({isLoading:!1,locations:t,pageNumber:a,totalPages:i})}})).catch(function(){var t=(0,i.Z)(g().mark((function t(n){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n);case 2:S.setState({isLoading:!1,locations:[]});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},r.deleteLocation=function(){var e=r.props.onErrorCatch,t=r.state.activeLocation;r.setState({isUpdating:!0}),L.b$.deleteLocationById({id:t.id,signal:r.signal}).then((function(){r.getLocationList()})).catch(e).finally((function(){r.setState({isUpdating:!1,activeLocation:null,showDeleteModal:!1})}))},r.handleDeleteModal=function(e){e&&e.id?r.setState({showDeleteModal:!0,activeLocation:e}):r.setState({activeLocation:null,showDeleteModal:!1})},r.getTableHeaders=function(){return["Id","Name","City","Type","Edit","Delete"]},r.getTableRows=function(){var e=r.props.router;return r.state.locations.map((function(t){var n=t.id,a=t.name,i=t.zipCode,o=t.state,s=t.locationType,l=t.locationId,c=t.city;return{id:n,columns:[l,a,[c,o,i].join(", "),N.ud[(0,S.invert)(N.Bq)[s]],(0,h.jsx)(y.Z,{variant:"outline-primary",onClick:function(){return e.push(m.cw.getDynamicPath(_.yy.LOCATIONS_UPDATE,[n]))},children:"Edit"},"".concat(n,"-edit")),(0,h.jsx)(y.Z,{variant:"outline-danger",onClick:function(){return r.handleDeleteModal(t)},children:"Delete"},"".concat(n,"-delete"))]}}))},r.getTableFilters=function(){var e=r.state,t=e.fields,n=e.validated,a=e.errors,i=t.type,o=t.name,s=t.sort;return[(0,h.jsx)(v.Ay,{value:o,name:"name",label:"Location Name",onChange:r.handleInputChange,errors:a,validated:n},"filter-name"),(0,h.jsx)(v.lq,{name:"type",label:N.OX.LOCATION_TYPE,onChange:r.handleInputChange,options:i,errors:a,validated:n,isMulti:!0},"filter-type"),(0,h.jsx)(v.lq,{name:"sort",value:s,label:"Sort By",onChange:r.handleInputChange,options:M,errors:a,validated:n},"filter-sort")]},r.handleResetFilters=function(){var e=r.state.fields;m.n2.deleteStorageItem(x),r.setState({pageNumber:m.L_.defaultPaginationState.pageNumber,pageSize:m.L_.defaultPaginationState.pageSize,fields:(0,u.Z)((0,c.Z)({},e),{type:m.L_.buildSelectOptions((0,S.invert)(N.Bq),N.ud),name:"",sort:N.Xc.DATE_CREATED})},(function(){return r.getLocationList()}))},r.handleSubmit=function(e){(0,s.Z)(((0,a.Z)(r),(0,l.Z)(n.prototype)),"handleSubmit",r).call(r,e),r.setState({pageNumber:m.L_.defaultPaginationState.pageNumber,totalPages:m.L_.defaultPaginationState.totalPages},(function(){return r.getLocationList()}))},r.handleSearchChange=function(e){r.setState(e,(function(){return r.getLocationList()}))},r.getLocationMap=function(){var e=r.state,t=e.locations,n=e.isGoogleReady?t.map((function(e){return m.aU.convertLocationToGoogleMapsLocation({location:e,fillColor:m.aU.getLocationTypeColor((0,S.invert)(N.Bq)[e.locationType]),info:(0,h.jsx)(v.Uz,{location:e})})})):[];return(0,h.jsx)(v.t2,{selectableLocations:n,onReady:function(){return r.setState({isGoogleReady:!0})},isAdmin:!0})};var p=(0,m.bX)(x);return r.state=(0,u.Z)((0,c.Z)({},N.uG,m.L_.defaultPaginationState),{pageNumber:(null===p||void 0===p?void 0:p.pageNumber)||m.L_.defaultPaginationState.pageNumber,pageSize:(null===p||void 0===p?void 0:p.pageSize)||m.L_.defaultPaginationState.pageSize,locations:[],showDeleteModal:!1,activeLocation:null,isGoogleReady:!1,isEventsMapOpen:!1,fields:{type:m.L_.buildSelectOptions((0,S.invert)(N.Bq),N.ud,null===p||void 0===p||null===(d=p.types)||void 0===d?void 0:d.split(",")),name:(null===p||void 0===p?void 0:p.name)||"",sort:(null===p||void 0===p?void 0:p.sort)||N.Xc.DATE_CREATED}}),r}var p=n.prototype;return p.componentDidMount=function(){(0,s.Z)((0,l.Z)(n.prototype),"componentDidMount",this).call(this),this.getLocationList()},p.render=function(){var e=this,t=this.props.router,n=this.state,a=n.isLoading,i=n.showDeleteModal,o=n.activeLocation,s=n.isUpdating,l=n.pageNumber,r=n.totalPages,c=n.pageSize,u=n.isEventsMapOpen;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(T.pV,{title:"Locations",onClick:function(){return t.push(_.yy.LOCATIONS_CREATE)},buttonText:"Create",variant:"outline-success"}),(0,h.jsx)(v.ly,{isLoading:a,children:(0,h.jsx)(v.tQ,{headers:this.getTableHeaders(),rows:this.getTableRows(),filters:this.getTableFilters(),pageNumber:l,pageSize:c,totalPages:r,onPaginationChange:this.handleSearchChange,isUpdating:s,onSubmit:this.handleSubmit,filterCacheKey:x,onResetFilters:this.handleResetFilters,subheader:(0,h.jsx)(C.Z,{children:(0,h.jsxs)(C.Z.Item,{eventKey:"0",onClick:function(){return e.setState({isEventsMapOpen:!u})},children:[(0,h.jsx)(C.Z.Header,{children:"Locations Map"}),(0,h.jsx)(C.Z.Body,{children:this.getLocationMap()})]})}),append:(0,h.jsx)("div",{id:"locations-container",children:this.getLocationMap()})})}),i&&(0,h.jsx)(v.VF,{show:i,body:(0,h.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,h.jsx)("strong",{children:o.name||o.lineOne}),"?"]}),title:"Delete Location?",onClick:this.deleteLocation,onClose:this.handleDeleteModal,buttonVariant:"outline-danger",buttonText:"Confirm Delete",isLoading:s})]})},n}(v.I);t.default=(0,b.withRouter)(E)}},function(e){e.O(0,[9774,2888,179],(function(){return t=18872,e(e.s=t);var t}));var t=e.O();_N_E=t}]);