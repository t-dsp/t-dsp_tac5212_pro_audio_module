(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7695],{52580:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/events",function(){return n(36076)}])},36076:function(e,t,n){"use strict";n.r(t);var a=n(54011),s=n(14134),i=n(33510),o=n(9551),r=n(89663),l=n(77423),d=n(66586),u=n(44922),c=n(11251),v=n(3335),h=n(15281),g=n.n(h),p=n(97458),m=n(1350),C=n(39378),f=n(78828),T=n(64533),S=n(66220),E=n(78778),b=n(82014),L=n(80515),j=n(63855),x=n(46623),y=n(65412),Z=n(94796),I=y.l6.EVENT_LIST,M=T.L_.buildSelectOptions(Z.Vw,Z.Q2),P=T.L_.buildSelectOptions(Z.GE,Z.TG),_=T.L_.buildSelectOptions(Z.dB,Z.xw),N={eventId:void 0,status:Z.XA,startTime:null,endTime:null,statusCategory:Z.XA},w=function(e){(0,l.Z)(n,e);var t=(0,v.Z)(n);function n(e){var l,v;(0,i.Z)(this,n),(l=t.call(this,e)).getEventList=function(){var e=l.props.onErrorCatch,t=l.state,n=t.pageNumber,i=t.pageSize,o=t.fields,r=o.status,v=o.startTime,h=o.endTime,p=o.eventId,C=o.statusCategory,f=o.sort,E=o.dispatchLocations;l.setState({isUpdating:!0});var b=m.QM.setSelectValueToCache(r),L=m.QM.setDateValueToCache(v),j=m.QM.setDateValueToCache(h),x=m.QM.setSelectValueToCache(C),y=m.QM.setSelectValueToCache(f),M=m.QM.setMultiselectValuesToCache(E),P={pageNumber:n,pageSize:i,status:b,startTime:L,endTime:j,eventId:(null===p||void 0===p?void 0:p.length)>0?p:void 0,statusCategory:x,eventSort:y,dispatchLocations:M},_={eventId:p,status:b,startTime:L,endTime:j,statusCategory:x,sort:y,dispatchLocations:M};(0,T.bj)(I,_);var N={types:[Z.Bq.DISPATCH_LOCATIONS].join(","),pageSize:100,pageNumber:1},w=(0,a.Z)(l);Promise.all([S.vo.getAllEvents({queryParameters:P,signal:l.signal}),S.b$.getAllLocations({queryParameters:N,signal:l.signal})]).then((function(e){var t=T.sm.getResultsFromResponse(e[0]),n=T.sm.getPaginationFromResponse(e[0]),a=T.sm.getResultsFromResponse(e[1]);if(0===t.length)l.setState({isLoading:!1,isUpdating:!1,events:t});else{var s=n.pageNumber,i=n.totalPages;l.setState({isLoading:!1,isUpdating:!1,events:t,pageNumber:s,totalPages:i,fields:(0,u.Z)((0,d.Z)({},o),{dispatchLocations:[Z.VT].concat((0,c.Z)(a.map((function(e){var t,n=e.id;return{id:n,value:[e.city,e.state].join(", "),selected:null===_||void 0===_||null===(t=_.dispatchLocations)||void 0===t?void 0:t.includes(n)}}))))})})}})).catch(function(){var t=(0,s.Z)(g().mark((function t(n){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n);case 2:w.setState({isLoading:!1,isUpdating:!1,events:[]});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},l.handleSubmit=function(e){(0,o.Z)(((0,a.Z)(l),(0,r.Z)(n.prototype)),"handleSubmit",l).call(l,e),l.setState({pageNumber:T.L_.defaultPaginationState.pageNumber,totalPages:T.L_.defaultPaginationState.totalPages},(function(){return l.getEventList()}))},l.getTableFilters=function(){var e=l.state,t=e.fields,n=e.validated,a=e.errors,s=t.status,i=t.startTime,o=t.endTime,r=t.eventId,d=t.statusCategory,u=t.sort,c=t.dispatchLocations;return[(0,p.jsx)(f.Ay,{value:r,name:"eventId",label:"Event Id",onChange:l.handleInputChange,errors:a,validated:n},"event-id"),(0,p.jsx)(f.lq,{value:s,name:"status",label:"Event Status",onChange:l.handleInputChange,errors:a,validated:n,options:M},"event-status"),(0,p.jsx)(f.Wr,{value:i,name:"startTime",label:"Events On or After",onChange:l.handleInputChange,errors:a,validated:n},"event-start"),(0,p.jsx)(f.Wr,{value:o,name:"endTime",label:"Events On or Before",onChange:l.handleInputChange,errors:a,validated:n},"event-end"),(0,p.jsx)(f.lq,{value:d,name:"statusCategory",label:"Event Status Category",onChange:l.handleInputChange,errors:a,validated:n,options:P},"event-status-category"),(0,p.jsx)(f.lq,{name:"dispatchLocations",label:"Dispatch Locations",onChange:l.handleInputChange,errors:a,validated:n,options:c,isMulti:!0},"event-dispatch"),(0,p.jsx)(f.lq,{value:u,name:"sort",label:"Sort",onChange:l.handleInputChange,errors:a,validated:n,options:_},"event-sort")]},l.handleCreateModal=function(e){l.setState({showCreateModal:e})},l.createEvent=function(){var e=l.state.fields,t=e.sendThankYouEmail,n=e.sendToDjep;T.cw.openNewTab({pathname:"https://client.shoemakerjukebox.com",queryParameters:{sendThankYouEmail:t,sendToDjep:n}}),l.setState({showCreateModal:!1})},l.handleResetFilters=function(){var e=l.state.fields;T.n2.deleteStorageItem(I),l.setState({fields:(0,d.Z)({},e,N)},(function(){return l.getEventList()}))},l.handleEventCalendarSelect=function(e){var t=e.eventStatusCategory,n=e.startTime,a=e.endTime,s=l.state.fields;l.setState({fields:(0,u.Z)((0,d.Z)({},s,N),{statusCategory:t||Z.XA,startTime:n,endTime:a})},(function(){return l.getEventList()}))},l.handlePaginationChange=function(e){l.setState(e,(function(){return l.getEventList()}))},l.getEventMap=function(){var e=l.state,t=e.events,n=e.isGoogleReady?t.map((function(e){return T.aU.convertLocationToGoogleMapsLocation({location:e.location,fillColor:T.PO.getEventStatusColor(e.status),info:(0,p.jsx)(f.$W,{event:e})})})):[];return(0,p.jsx)(f.t2,{selectableLocations:n,onReady:function(){return l.setState({isGoogleReady:!0})},isAdmin:!0})};var h=(0,T.bX)(I);return l.state=(0,u.Z)((0,d.Z)({},Z.uG,T.L_.defaultPaginationState),{events:[],showCreateModal:!1,isGoogleReady:!1,fields:{status:(null===h||void 0===h?void 0:h.status)||Z.XA,startTime:(null===h||void 0===h?void 0:h.startTime)?T.Cv.getDate(h.startTime):void 0,endTime:(null===h||void 0===h?void 0:h.endTime)?T.Cv.getDate(h.endTime):void 0,sendThankYouEmail:!1,sendToDjep:!1,eventId:(null===h||void 0===h?void 0:h.eventId)||void 0,statusCategory:(null===h||void 0===h?void 0:h.statusCategory)||Z.XA,sort:(null===h||void 0===h?void 0:h.sort)||"MOST_RELEVANT",dispatchLocations:(null===h||void 0===h||null===(v=h.dispatchLocations)||void 0===v?void 0:v.split(",").map((function(e){return{id:e,value:"",selected:!0}})))||[]}}),l}var h=n.prototype;return h.componentDidMount=function(){(0,o.Z)((0,r.Z)(n.prototype),"componentDidMount",this).call(this),this.getEventList()},h.componentDidUpdate=function(e){(0,C.isEqual)(e.router,this.props.router)||this.getEventList()},h.render=function(){var e=this,t=this.props.onErrorCatch,n=this.state,a=n.isLoading,s=n.events,i=n.pageNumber,o=n.totalPages,r=n.pageSize,l=n.isUpdating,d=n.showCreateModal,u=n.fields,c=u.sendThankYouEmail,v=u.sendToDjep;return(0,p.jsxs)("div",{id:"events-container",children:[(0,p.jsxs)(f.ly,{isLoading:a,children:[(0,p.jsx)(x.pV,{title:"Events",onClick:function(){return e.handleCreateModal(!0)},buttonText:"Create",variant:"outline-success"}),(0,p.jsx)(b.Z,{defaultActiveKey:"0",children:(0,p.jsxs)(b.Z.Item,{eventKey:"0",children:[(0,p.jsx)(b.Z.Button,{className:"cursor-pointer",children:"Calendar & Map"}),(0,p.jsx)(b.Z.Body,{children:(0,p.jsxs)(L.Z,{children:[(0,p.jsx)(j.Z,{xs:12,md:6,children:(0,p.jsx)(x.LY,{onSelect:this.handleEventCalendarSelect,onErrorCatch:t})}),(0,p.jsx)(j.Z,{xs:12,md:6,children:this.getEventMap()})]})})]})}),(0,p.jsx)(x.Y6,{title:"Events List",events:s,filters:this.getTableFilters(),pageNumber:i,pageSize:r,totalPages:o,onSubmit:this.handleSubmit,isUpdating:l,onResetFilters:this.handleResetFilters,onPaginationChange:this.handlePaginationChange,filterCacheKey:I})]}),d&&(0,p.jsx)(f.VF,{show:d,body:(0,p.jsxs)(L.Z,{children:[(0,p.jsx)(j.Z,{children:(0,p.jsx)(f.I0,{value:c,name:"sendThankYouEmail",label:"Send Thank You Email?",onChange:this.handleInputChange})}),(0,p.jsx)(j.Z,{children:(0,p.jsx)(f.I0,{value:v,name:"sendToDjep",label:"Send to DJEP?",onChange:this.handleInputChange})})]}),title:"Create Event",onClick:this.createEvent,onClose:function(){return e.handleCreateModal(!1)},buttonVariant:"outline-primary",buttonText:"Create",isLoading:l})]})},n}(f.I);t.default=(0,E.withRouter)(w)}},function(e){e.O(0,[9774,2888,179],(function(){return t=52580,e(e.s=t);var t}));var t=e.O();_N_E=t}]);