(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2994],{2093:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/calendar-items",function(){return n(9751)}])},9751:function(t,e,n){"use strict";n.r(e);var a=n(54011),r=n(14134),s=n(33510),i=n(55388),o=n(9551),c=n(89663),l=n(77423),d=n(66586),m=n(44922),u=n(3335),v=n(15281),h=n.n(v),p=n(97458),g=n(78828),f=n(64533),C=n(66220),T=n(83849),D=n.n(T),y=n(89845),w=n(78778),E=n(89711),x=n(40645),N=n(80515),S=n(63855),j=n(94796),A=n(46623),Z=n(65412),I=(0,E.k2)(y.ou),_=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(t){var o;return(0,s.Z)(this,n),(o=e.call(this,t)).getCalendarItemList=function(){var t=o.props.onErrorCatch,e=o.state,n=e.startTime,s=e.endTime;o.setState({isUpdating:!0});var c={type:Z.J7.APPOINTMENT,startTime:f.Cv.getDate(n).minus({month:1}).toJSDate().toISOString(),endTime:f.Cv.getDate(s).toJSDate().toISOString()},l=(0,a.Z)(o);C.m$.getAllCalendarItems({queryParameters:c,signal:o.signal}).then((function(t){var e=f.sm.getResultsFromResponse(t),n=e.map((function(t){var e=t.id,n=t.title,a=t.startTime,r=t.endTime,s=t.type,i=f.Cv.convertUtcToLocalTimezone(a);return{id:e,title:n,start:f.Cv.convertUtcToLocalTimezone(a).set({month:i.month,day:i.day}).toJSDate(),end:f.Cv.convertUtcToLocalTimezone(r).set({month:i.month,day:i.day}).toJSDate(),resource:s}})),a={},r=Object.values(e.map((function(t){var e=t.id,n=t.title,a=t.startTime,r=t.type,s=t.endTime;return{id:e,title:n,start:f.Cv.convertUtcToLocalTimezone(a).toJSDate(),end:f.Cv.convertUtcToLocalTimezone(s).toJSDate(),resource:r}})).reduce((function(t,e){var n,r=(0,d.Z)({},t),s=e.start,o=f.Cv.formatDate(s),c=[o].join("-"),l=(null===(n=r[c])||void 0===n?void 0:n.count)+1||1,u=a[o]||0;a[o]=u+1;var v={title:"Appt. (".concat(l,")"),count:l,start:s,end:s};return(0,m.Z)((0,d.Z)({},r),(0,i.Z)({},c,v))}),{}));r.sort((function(t,e){return t.title.localeCompare(e.title)})),o.setState({isLoading:!1,isUpdating:!1,calendarItems:e,defaultEvents:n,monthEvents:r})})).catch(function(){var e=(0,r.Z)(h().mark((function e(n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:l.setState({isLoading:!1,isUpdating:!1,calendarItems:[]});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},o.handleSelectEvent=function(t){var e=o.state.isMonthView,n=t.start;e&&"count"in t?o.setState({selectedDay:f.Cv.getDate(n)}):"id"in t&&window.open(f.cw.getDynamicPath(Z.yy.CALENDAR_ITEMS_UPDATE,[t.id]),"_blank")},o.renderMonthEvent=function(t){var e=t.event;return(0,p.jsx)("div",{className:"badge calendar-item-badge event-status-category-all",children:e.title})},o.handleViewChange=function(t){o.setState({view:t,isMonthView:t===E.kO.MONTH})},o.renderAppointmentItems=function(){var t=o.props.router,e=o.state,n=e.calendarItems,a=e.selectedDay,r=a?"No calendar items for ".concat(f.Cv.formatDate(a)):"No day selected",s=a?n.filter((function(t){return f.Cv.formatDate(t.startTime)===f.Cv.formatDate(a)})):[];return 0===s.length?(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col",children:(0,p.jsx)(g.g5,{message:r,variant:"primary"})})}):s.sort((function(t,e){return new Date(t.startTime).valueOf()-new Date(e.startTime).valueOf()})).map((function(e){var n=e.id,a=e.title,r=e.startTime;return(0,p.jsx)(g.g5,{variant:"secondary",className:"pt-1 pb-1 mb-3",message:(0,p.jsx)(x.Z,{variant:"link",className:"m-0 p-0 text-start w-100",onClick:function(){return t.push(f.cw.getDynamicPath(Z.yy.CALENDAR_ITEMS_UPDATE,[n]))},children:(0,p.jsxs)(N.Z,{children:[(0,p.jsx)(S.Z,{children:a}),(0,p.jsx)(S.Z,{className:"col-auto",children:f.Cv.formatTimeOverTwelveHours(r)})]})})},n)}))},o.handleRangeChange=function(t){Array.isArray(t)?Array.isArray(t)&&t.length>0&&o.setState({startTime:f.Cv.getDate(t[0]),endTime:f.Cv.getDate(t[t.length-1]),selectedDay:void 0},(function(){return o.getCalendarItemList()})):o.setState({startTime:f.Cv.getDate(t.start),endTime:f.Cv.getDate(t.end),selectedDay:void 0},(function(){return o.getCalendarItemList()}))},o.state=(0,m.Z)((0,d.Z)({},j.uG),{calendarItems:[],showDeleteModal:!1,activeCalendarItem:void 0,selectedDay:f.Cv.getDate(),startTime:f.Cv.getDate().minus({days:30}),endTime:f.Cv.getDate().plus({days:30}),defaultEvents:[],monthEvents:[],view:E.kO.MONTH,isMonthView:!0}),o}var v=n.prototype;return v.componentDidMount=function(){(0,o.Z)((0,c.Z)(n.prototype),"componentDidMount",this).call(this),this.getCalendarItemList()},v.render=function(){var t=this.props.router,e=this.state,n=e.isLoading,a=e.selectedDay,r=e.defaultEvents,s=e.monthEvents,i=e.view,o=e.isMonthView;return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(g.ly,{isLoading:n,children:[(0,p.jsx)(A.pV,{title:"Calendar Items"}),(0,p.jsxs)(N.Z,{children:[(0,p.jsx)(S.Z,{xs:12,md:8,id:"calendar-items-container",children:(0,p.jsx)("div",{className:D()("calendar-container",{month:o}),children:(0,p.jsx)(E.f,(0,m.Z)((0,d.Z)({},{}),{localizer:I,events:o?s:r,startAccessor:"start",endAccessor:"end",components:{month:{event:this.renderMonthEvent}},popup:!0,dayLayoutAlgorithm:"no-overlap",onView:this.handleViewChange,view:i,onSelectEvent:this.handleSelectEvent,onRangeChange:this.handleRangeChange}))})}),(0,p.jsxs)(S.Z,{xs:12,md:4,children:[(0,p.jsx)(g.M$,{title:(0,p.jsxs)(p.Fragment,{children:["Appointments"," ",a&&(0,p.jsxs)("small",{className:"ml-1",children:["(",f.Cv.formatDate(a),")"]})]}),onClick:function(){return t.push(Z.yy.CALENDAR_ITEMS_CREATE)},className:""}),this.renderAppointmentItems()]})]})]})})},n}(g.H6);e.default=(0,w.withRouter)(_)}},function(t){t.O(0,[9774,2888,179],(function(){return e=2093,t(t.s=e);var e}));var e=t.O();_N_E=e}]);