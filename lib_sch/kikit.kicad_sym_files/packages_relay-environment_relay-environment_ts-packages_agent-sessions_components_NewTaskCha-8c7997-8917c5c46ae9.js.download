"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["packages_relay-environment_relay-environment_ts-packages_agent-sessions_components_NewTaskCha-8c7997"],{51120:(e,t,r)=>{r.d(t,{I:()=>i,j:()=>FetchCAPI401Error});var n=r(34295),s=r(25641),a=r(21067);let FetchCAPI401Error=class FetchCAPI401Error extends Error{constructor(e){super(e),this.name="FetchCAPI401Error"}};async function i({path:e,apiURL:t,method:r="GET",streamingResponse:i=!1,body:o}){let l=new n.l,c=await l.getAuthToken();if(!c)throw Error("No token available");let u={authToken:c,basePath:(0,a._$)().copilotApiOverrideUrl??t??"https://api.githubcopilot.com",method:r,path:e,streamingResponse:i,body:o},d=await (0,s.p)(u);if(!d.ok){if(401===d.status)throw new FetchCAPI401Error("Unauthorized access - token may be invalid or expired");throw Error("Failed to fetch agent sessions")}return d}},11418:(e,t,r)=>{let n;r.d(t,{H:()=>$});var s=r(35750),a=r(18150),i=r(85242),o=r(88243),l=r(16213),c=r(10204),u=new WeakMap,d=new WeakSet;let AliveSession=class AliveSession extends c.ib{constructor(e,t,r,n,s){super(e,()=>(0,o._)(this,d,h).call(this),r,n,void 0,s),(0,l._)(this,d),(0,a._)(this,u,{writable:!0,value:void 0}),(0,i._)(this,u,t)}};function h(){return p((0,s._)(this,u))}async function p(e){let t=await f(e);return t&&t.url&&t.token?b(t.url,t.token):null}async function f(e){let t=await fetch(e,{headers:{Accept:"application/json"}});if(t.ok)return t.json();if(404===t.status)return null;throw Error("fetch error")}async function b(e,t){let r=await fetch(e,{method:"POST",mode:"same-origin",headers:{"Scoped-CSRF-Token":t}});if(r.ok)return r.text();throw Error("fetch error")}var m=r(70170),g=r(34095),w=r(82075),y=r(23683),S=r(69599);function _(e,{channel:t,type:r,data:n}){for(let s of e)s.dispatchEvent(new CustomEvent(`socket:${r}`,{bubbles:!1,cancelable:!1,detail:{name:t,data:n}}))}var v=new WeakMap,k=new WeakMap,x=new WeakMap,E=new WeakMap,P=new WeakMap,A=new WeakSet;let I=class AliveSessionProxy{subscribe(e){let t=(0,s._)(this,k).add(...e);t.length&&(0,s._)(this,v).port.postMessage({subscribe:t});let r=new Set(t.map(e=>e.name)),n=e.reduce((e,t)=>{let n=t.topic.name;return(0,c.JR)(n)&&!r.has(n)&&e.add(n),e},new Set);n.size&&(0,s._)(this,v).port.postMessage({requestPresence:Array.from(n)})}unsubscribeAll(...e){let t=(0,s._)(this,k).drain(...e);t.length&&(0,s._)(this,v).port.postMessage({unsubscribe:t});let r=(0,s._)(this,x).removeSubscribers(e);this.sendPresenceMetadataUpdate(r)}updatePresenceMetadata(e){let t=new Set;for(let r of e)(0,s._)(this,x).setMetadata(r),t.add(r.channelName);this.sendPresenceMetadataUpdate(t)}sendPresenceMetadataUpdate(e){if(!e.size)return;let t=[];for(let r of e)t.push({channelName:r,metadata:(0,s._)(this,x).getChannelMetadata(r)});(0,s._)(this,v).port.postMessage({updatePresenceMetadata:t})}online(){(0,s._)(this,v).port.postMessage({online:!0})}offline(){(0,s._)(this,v).port.postMessage({online:!1})}hangup(){(0,s._)(this,v).port.postMessage({hangup:!0})}constructor(e,t,r,n,u,d){(0,l._)(this,A),(0,a._)(this,v,{writable:!0,value:void 0}),(0,a._)(this,k,{writable:!0,value:new c.m0}),(0,a._)(this,x,{writable:!0,value:new c.VH}),(0,a._)(this,E,{writable:!0,value:void 0}),(0,a._)(this,P,{writable:!0,value:new Map}),(0,i._)(this,E,u),(0,i._)(this,v,new SharedWorker(`${e}?module=true`,{name:`github-socket-worker-v3-${n}`,type:"module"})),(0,s._)(this,v).port.onmessage=({data:e})=>(0,o._)(this,A,C).call(this,e),(0,s._)(this,v).port.postMessage({connect:{url:t,refreshUrl:r,options:d}})}};function C(e){let{channel:t}=e;if("presence"===e.type){let r=(0,s._)(this,P).get(t);r||(r=(0,m.s)((e,r)=>{(0,s._)(this,E).call(this,e,r),(0,s._)(this,P).delete(t)},100),(0,s._)(this,P).set(t,r)),r((0,s._)(this,k).subscribers(t),e);return}(0,s._)(this,E).call(this,(0,s._)(this,k).subscribers(t),e)}async function O(){let e=function(){let e=document.head.querySelector("link[rel=shared-web-socket-src]")?.getAttribute("href");return e&&e.startsWith("/")?e:null}();if(!e)return;let t=document.head.querySelector("link[rel=shared-web-socket]")?.href??null;if(!t)return;let r=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-refresh-url")??null;if(!r)return;let n=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-session-id")??null;if(!n)return;let s=(()=>{let s=(0,S.G7)("alive_legacy_retries")?{socketPolicy:{timeout:4e3,attempts:7}}:{};if(!(0,y.nr)()&&"SharedWorker"in window&&"true"!==(0,w.A)("localStorage").getItem("bypassSharedWorker"))try{return new I(e,t,r,n,_,s)}catch{}return new AliveSession(t,r,!1,_,s)})();return window.addEventListener("online",()=>s.online()),window.addEventListener("offline",()=>s.offline()),window.addEventListener("pagehide",()=>{"hangup"in s&&s.hangup()}),s}async function T(){return await g.G,O()}function $(){return n||(n=T())}},73056:(e,t,r)=>{r.d(t,{$:()=>i});var n=r(10204),s=r(33303);let a=new WeakMap;function i(e,t,r){let i;if(!e)throw Error("Not connected to alive");if(!t)throw Error("No channel name");let o=n.KK.parse(t);if(!o)throw Error("Invalid channel name");let l={subscriber:{dispatchEvent:e=>{e instanceof CustomEvent&&r(e.detail.data)}},topic:o},c=((i=a.get(e))||(i={subscribe:(0,s.rK)(t=>e.subscribe(t.flat())),unsubscribeAll:(0,s.rK)(t=>e.unsubscribeAll(...t))},a.set(e,i)),i);return c.subscribe([l]),{unsubscribe:()=>c.unsubscribeAll(l.subscriber)}}},34295:(e,t,r)=>{r.d(t,{l:()=>AgentSessionsTokenProvider});var n=r(65411);let AgentSessionsTokenProvider=class AgentSessionsTokenProvider extends n.J{constructor(){super([],"/copilot/agent-sessions/token","AGENT_SESSIONS_TOKEN")}}},33303:(e,t,r)=>{function n(){return Promise.resolve()}function s(){return new Promise(window.requestAnimationFrame)}async function a(e,t){let r,n=new Promise(t=>{r=self.setTimeout(t,e)});if(!t)return n;try{var s;await Promise.race([n,(s=t,new Promise((e,t)=>{let r=Error("aborted");r.name="AbortError",s.aborted?t(r):s.addEventListener("abort",()=>t(r))}))])}catch(e){throw self.clearTimeout(r),e}}function i(e){let t=[];return function(r){t.push(r),1===t.length&&queueMicrotask(()=>{let r=t.slice(0);t.length=0,e(r)})}}r.d(t,{G$:()=>s,k2:()=>n,rK:()=>i,uk:()=>a})},37285:(e,t,r)=>{r.d(t,{Av:()=>o,BM:()=>s,Gr:()=>l,HX:()=>d,M_:()=>h,RD:()=>u,rb:()=>a});var n=r(71315);let s="GraphQLTraces",a="GraphQLTracingRefresh",i=decodeURIComponent(new URLSearchParams(n.fV.search).get("disable_clusters")||"").split(",").filter(e=>""!==e);function o(e){if(!n.cg||!l()||!e)return;let t=n.cg;t&&!t[s]&&(t[s]=[]),t&&e.__trace&&(t[s].push(e.__trace),"function"==typeof t[a]&&t[a]())}function l(){let e=n.cg;return"true"===new URLSearchParams(n.fV.search).get("_tracing")||e&&void 0!==e[s]}function c(){return i.length>0}function u(e){if(!l()&&!c())return e;let t=new URL(e,n.fV.origin);return l()&&t.searchParams.set("_tracing","true"),c()&&t.searchParams.set("disable_clusters",i.join(",")),t.pathname+t.search}function d(e){return i.indexOf(e)>-1}function h(e){let t=i.indexOf(e);t>-1?i.splice(t,1):i.push(e);let r=new URLSearchParams(n.fV.search);r.set("disable_clusters",i.join(",")),n.fV.search=r.toString()}},30721:(e,t,r)=>{r.d(t,{VB:()=>SSRNetwork,SD:()=>I,E7:()=>A});var n=r(50467),s=r(40961),a=r(69487),i=r(37285),o=r(96379),l=r(71315),c=r(38102);let u=["SAML","SERVICE_UNAVAILABLE"],d={FORBIDDEN:["SAML error"],AUTHENTICATION:["Couldn\u2019t authenticate you"]},h={NOT_FOUND:[["repository","issue"]]};var p=r(51987);function f(e,t){let r=h[e];if(!r)return!1;for(let e of r){if(t.length!==e.length)continue;let r=!0;for(let n=0;n<t.length;n++)if(t[n]!==e[n]&&"*"!==e[n]){r=!1;break}if(r)return!1}return!0}let b=class ValidationError extends Error{constructor(e,t,r){super(e,t),(0,n._)(this,"catalogService",void 0),this.catalogService=r,this.name="ValidationError"}};async function m(e,t,r){if(e.status>401&&404!==e.status){let n=await e.text(),s={url:e.url,timestamp:new Date().toISOString(),persistedQueryId:t,persistedQueryName:r,failureRequestId:e.headers.get("X-Github-Request-Id")},a=`HTTP error (${e.status}): ${n||"No additional text"}.
    Error Info: ${JSON.stringify(s)}`;if(429===e.status)throw{message:a,cause:e.status};throw Error(a,{cause:e.status})}}async function g(e,t,r,n="GET",s,a,i,o){return(await w(e,t,r,n,{isSubscription:!1,scope:void 0},s,a,i,o)).response}async function w(e,t,r,n="POST",s={},o,h,p,m){let g=JSON.stringify((0,a.stableCopy)({query:e,variables:r,...s.scopeObject?{scopeObject:s.scopeObject}:{}})),{isSubscription:S,scope:_,subscriptionTopic:v,dispatchTime:k}=s,x=function(e,t,r,n,s,a,i="/_graphql"){let o=[];if("GET"===e&&o.push(`body=${t}`),r&&o.push("subscription=1"),s&&o.push(`scope=${encodeURIComponent(s)}`),n&&o.push(`subscriptionTopic=${encodeURIComponent(n)}`),a&&o.push(`dispatchTime=${encodeURIComponent(a)}`),l.cg){let e=new URL(l.cg.location.href,l.cg.location.origin).searchParams.get("_features");e&&o.push(`_features=${e}`)}return o.length>0?`${i}?${o.join("&")}`:i}(n,encodeURIComponent(g),S,v,_,k,o),E=null;try{let{subscriptionId:r,requestId:s,json:a,status:o}=await y(x,n,e,t,g,h);if(E=r,p&&a.errors){let e=p[o];if(e)for(let r of a.errors){let n=e[r.type];n?.({persistedQueryName:t,errorMessage:r.message})}}let l=function(e,t,r,n){var s,a;if(s=t,a=e,"errors"in a&&(a.errors.filter(e=>{let t=u.includes(e.type)||!!d[e.type]?.includes(e.message),r=f(e.type,e.path);return t||r}).map(e=>{console.error(`Failed to fetch data. Please use this request ID when contacting support: ${s} Error: ${e.type}: ${e.message} (path: ${e.path})`)}),a.errors=a.errors.filter(e=>{let t=u.includes(e.type)||!!d[e.type]?.includes(e.message),r=f(e.type,e.path);return!t&&!r})),"errors"in e&&e.errors.length){let t=e.errors.map(e=>`GraphQL error: ${e.type}: ${e.message} (path: ${e.path})`).join(", "),s=new b(`${t} (Persisted query id: ${r})`,{cause:e.errors},e.extensions?.query_owning_catalog_service);if(n)(0,c.N7)(s),n.error(s);else throw s}if(!("data"in e)){let s=Error(`Expected data property in response: ${JSON.stringify(e)}. persistedQueryId: ${r}, requestId: ${t}`);if(n)(0,c.N7)(s),n.error(s);else throw s}return e}(a,s,e,m);return l&&(0,i.Av)(l),{subscriptionId:E,response:l}}catch(e){if(m)return"object"==typeof e&&null!==e&&"cause"in e&&429===e.cause||(0,c.N7)(e),m.error(e),{subscriptionId:E,response:{errors:[{message:"An error occurred while fetching data. Please try again later."}],extensions:{}}};throw e}}async function y(e,t,r,n,s,a){return S((0,i.RD)(e),t,r,n,s,a)}async function S(e,t,r,n,s,a){let i,l,u={...(0,p.kt)()};a?.issues_react_perf_test&&(u["X-LUC-Environment"]="issues");let d=(i="GET"===t?await fetch(e,{method:t,cache:"no-cache",credentials:"include",headers:{Accept:"application/json",...u}}):await (0,o.DI)(e,{method:t,headers:{Accept:"application/json",...u},...s?{body:s}:void 0})).headers.get("X-Subscription-ID"),h=i.headers.get("X-Github-Request-Id")||"",f=i.status;await m(i,r,n);try{l=await i.json()}catch(r){let t={error:r,status:f,url:e,requestId:h};throw(0,c.N7)(Error(`Failed to parse server JSON response ${JSON.stringify(t)}`)),Error(`Failed to parse server response. Please try again later. ${JSON.stringify(t)}`)}return{subscriptionId:d,requestId:h,json:l,status:f}}let _=[{kind:"linked",handle(e,t,r){if(null!=t&&t.getType()===a.ROOT_TYPE&&"node"===e.name&&r.hasOwnProperty("id"))return r.id}},{kind:"pluralLinked",handle(e,t,r){if(null!=t&&t.getType()===a.ROOT_TYPE&&"nodes"===e.name&&r.hasOwnProperty("ids"))return r.ids}}];var v=r(11418),k=r(73056),x=r(69982);function E(e){return(0,x.unstable_scheduleCallback)(x.unstable_LowPriority,e)}let P={cancel:()=>!1,schedule:e=>((0,s.unstable_batchedUpdates)(e),"")};let SSRNetwork=class SSRNetwork{execute(e,t,r){return this.relayNetwork.execute(e,t,r)}getPreloadedSubscriptions(){return this.preloadedSubscriptions}constructor(e,t={},r,s,i,o){(0,n._)(this,"relayNetwork",void 0),(0,n._)(this,"ssrPreloadedData",void 0),(0,n._)(this,"preloadedSubscriptions",void 0),(0,n._)(this,"warningsShown",void 0),(0,n._)(this,"enabled_features",void 0),(0,n._)(this,"maxAge",void 0),(0,n._)(this,"errorCallbacks",void 0),this.ssrPreloadedData=e,this.enabled_features=t,this.preloadedSubscriptions=r,this.warningsShown=new Set,this.maxAge=i,this.errorCallbacks=o,this.relayNetwork=a.Network.create((e,t)=>a.Observable.create(r=>{let n=function({params:e,variables:t,ssrPreloadedQueries:r,baseUrl:n,emitWarning:s,enabledFeatures:a,maxAge:i,errorCallbacks:o,observer:c}){if(!e.id)throw Error("params has no id property!");if(e.id&&r){let n=JSON.stringify(t),s=r.get(e.id)?.get(n),a=Math.floor(Date.now()/1e3),o=s?.timestamp;if(s&&(c.next(s),!(i&&o&&a>o+i)))return void c.complete();e.metadata?.isRelayRouteRequest&&(0,l.g5)()}let u="mutation"===e.operationKind?"POST":"GET";if(l.KJ)return g(e.id,e.name,t,u,n,a,o,c)}({params:e,variables:t,ssrPreloadedQueries:this.ssrPreloadedData,baseUrl:s,emitWarning:e=>{this.warningsShown.has(e)||(this.warningsShown.add(e),console.warn(e))},enabledFeatures:this.enabled_features,maxAge:i,errorCallbacks:this.errorCallbacks,observer:r});n instanceof Promise&&n.then(e=>{if(!Array.isArray(e)&&"extensions"in e&&e.extensions&&e.extensions.subscriptions){let t=e.extensions.subscriptions;for(let e in t)for(let r in this.preloadedSubscriptions.has(e)||this.preloadedSubscriptions.set(e,new Map),t[e])this.preloadedSubscriptions.get(e)?.set(r,t[e][r])}r.next(e),r.complete()})}),(e,t)=>(function(e,t,r=new Map){let n=e.id,s=e.name;return a.Observable.create(a=>{let i=()=>{},o=!1;return async function(){if(!n)throw Error("unexpected operation with no id!");let l=e.metadata?.scope,u=function(e,t,r,n){let s=n.get(e);if(s)e:for(let[e,n]of s){for(let[n,s]of Object.entries(JSON.parse(e)))if("$scope"===n&&r!==s||t[n]!==s)continue e;return n}}(n,t,l,r),d=null;if(u)d=u.subscriptionId,u.response&&a.next(u.response);else try{let e=await w(n,s,t,"GET",{isSubscription:!0,scope:l});d=e.subscriptionId,e.response&&a.next(e.response)}catch(e){if(e instanceof Error&&e.message.includes("Subscription halted"))return;throw e}try{let e=await (0,v.H)();if(o)return;let r=(0,k.$)(e,d,async({scope_object:e,subscription_topic:r,dispatch_time:i})=>{try{let{response:o}=await w(n,s,{...t},"GET",{isSubscription:!0,scopeObject:e,subscriptionTopic:r,dispatchTime:i,scope:l});o&&a.next(o)}catch(e){(0,c.N7)(e,{message:`Error in fetching update for ${n} with variables ${JSON.stringify(t)}`})}});r?.unsubscribe&&(i=r.unsubscribe)}catch(e){a.error(e)}}(),{get closed(){return o},unsubscribe(){o=!0,i()}}})})(e,t,this.preloadedSubscriptions))}};let A=(e,t)=>{let r=new SSRNetwork(new Map,{},new Map,e,void 0,t),n=new a.Environment({scheduler:P,store:new a.Store(new a.RecordSource,{gcReleaseBufferSize:50,queryCacheExpirationTime:3e5,gcScheduler:E}),getDataID:(e,t)=>{if("Viewer"===t)return null==e.id?(0,a.generateClientID)("client:root","viewer"):e.id;if("ProjectV2SingleSelectFieldOption"===t){let t=[];return e.id&&t.push(e.id),e.name&&t.push(e.name),e.color&&t.push(e.color),e.description&&t.push(function(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t}(e.description)),t.join("_")}return e.id},network:r,missingFieldHandlers:_});return n.options={baseUrl:e,getPreloadedSubscriptions:()=>r.getPreloadedSubscriptions()},n};function I({environment:e,query:t,variables:r={}}){let n=(0,a.getRequest)(t),s=(0,a.createOperationDescriptor)(n,r);return e.retain(s),(0,a.fetchQuery)(e,t,r,{fetchPolicy:"store-or-network"})}},79512:(e,t,r)=>{r.d(t,{Q:()=>S});var n=r(74848),s=r(82346),a=r(33592),i=r(96540),o=r(96379),l=r(6011),c=r(46642),u=r(38411),d=r(69599),h=r(13017),p=r(21728),f=r(5945),b=r(52446),m=r(51120),g=r(42455);function w(e){let t,r,s,a,i,o=(0,p.c)(16),{apiURL:l,selectedAgent:c,onSelect:u,selectedRepo:d}=e,h=d?.owner||null,w=d?.nameOnly||null;o[0]!==l||o[1]!==h||o[2]!==w?(t={apiURL:l,owner:h,repo:w},o[0]=l,o[1]=h,o[2]=w,o[3]=t):t=o[3];let{data:y,isLoading:S}=function(e){let t,r,n,s,a=(0,p.c)(13),{apiURL:i,owner:o,repo:l}=e;a[0]!==o||a[1]!==l?(t=["subagents",o,l],a[0]=o,a[1]=l,a[2]=t):t=a[2],a[3]!==i||a[4]!==o||a[5]!==l?(r=async()=>{try{let e=await (0,m.I)({apiURL:i,path:`/agents/swe/internal/subagents/${o}/${l}`});if(404===e.status)return[];return(await e.json()).agents}catch{return[]}},a[3]=i,a[4]=o,a[5]=l,a[6]=r):r=a[6];let c=!!(o&&l);a[7]!==t||a[8]!==r||a[9]!==c?(n={queryKey:t,queryFn:r,enabled:c},a[7]=t,a[8]=r,a[9]=c,a[10]=n):n=a[10];let u=(0,g.b)(n);return a[11]!==u?(s={...u},a[11]=u,a[12]=s):s=a[12],s}(t);if(!d)return null;let _="Subagent";return c&&(_=`Subagent: ${c.charAt(0).toUpperCase()}${c.slice(1)}`),o[4]!==_?(r=(0,n.jsx)(f.W.Button,{children:_}),o[4]=_,o[5]=r):r=o[5],o[6]!==y||o[7]!==S||o[8]!==u||o[9]!==c?(s=S?(0,n.jsx)(b.l.Item,{children:"Loading subagents..."}):y&&0!==y.length?y.map(e=>(0,n.jsx)(b.l.Item,{selected:c===e.name,onSelect:()=>u(e.name),children:e.name.charAt(0).toUpperCase()+e.name.slice(1)},e.name)):(0,n.jsx)(b.l.Item,{children:"No subagents available"}),o[6]=y,o[7]=S,o[8]=u,o[9]=c,o[10]=s):s=o[10],o[11]!==s?(a=(0,n.jsx)(f.W.Overlay,{width:"medium",children:(0,n.jsx)(b.l,{selectionVariant:"single",children:s})}),o[11]=s,o[12]=a):a=o[12],o[13]!==r||o[14]!==a?(i=(0,n.jsxs)(f.W,{children:[r,a]}),o[13]=r,o[14]=a,o[15]=i):i=o[15],i}try{w.displayName||(w.displayName="SubAgentSelector")}catch{}async function y(e=""){let t=await (0,o.lS)("/copilot/agent-sessions/repositories");if(t.ok){let r=(await t.json()).repositories.map(e=>({id:e.id,nameWithOwner:e.nameWithOwner,enabled:e.enabled,name:e.nameWithOwner,nameOnly:e.name,owner:e.owner,defaultBranch:e.defaultBranch,private:"public"!==e.visibility}));if(e.trim()){let t=e.toLowerCase();r=r.filter(e=>e.nameWithOwner.toLowerCase().includes(t)||e.nameOnly.toLowerCase().includes(t))}return r}return[]}function S({apiURL:e,handleUserSubmit:t,initialRepo:r,hideRepoSelector:p}){let f=(0,a.b)(),[b,m]=(0,i.useState)(null),[g,S]=(0,i.useState)(!0),[_,v]=(0,i.useState)(!1),k=(0,d.G7)("copilot_immersive_agent_branch_selection"),[x]=(0,h.ok)(),E=x.get("branch"),[P,A]=(0,i.useState)(""),I=r&&`${r.ownerLogin}/${r.name}`,C=x.get("repo")??I,[O,T]=(0,i.useState)(null),$=(0,d.G7)("copilot_swe_agent_use_subagents");(0,i.useEffect)(()=>{if(r){let e=`${r.ownerLogin}/${r.name}`;m({id:r.id,owner:r.ownerLogin,name:e,nameOnly:r.name,nameWithOwner:e,enabled:!0,defaultBranch:r.defaultBranch,private:r.private});let t=E??r?.defaultBranch;if(t)A(t);else{let t=async()=>{try{let t=await (0,o.lS)(`/_filter/repositories?q=${e}`);if(!t.ok)return;let r=(await t.json()).repositories.find(t=>t.nameWithOwner===e);r&&A(r.defaultBranch)}finally{v(!1)}};v(!0),t()}f.clearCurrentReferences(),S(!1)}else(async()=>{try{let e=await y(),t=C?e.find(e=>e.nameWithOwner===C&&e.enabled):void 0;t||(t=e.find(e=>e.enabled)),t&&(m(t),A(E??t.defaultBranch))}catch{}finally{S(!1)}})()},[]);let N=(0,i.useCallback)(async e=>t(e,b,P,O||""),[t,b,P,O]);return(0,n.jsx)(s.V,{hideAttachmentButton:!0,hideAutocomplete:!0,placeholder:"Describe a coding task to work on",size:"large",onSubmit:N,submitButtonLabel:"Start task",extraToolbarLeft:(0,n.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[g?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.f,{height:"32px",width:"130px"})}):p?null:(0,n.jsx)(c.P,{repositoryLoader:y,selectionVariant:"single",selectAllOption:!1,onSelect:e=>{e&&(m(e),A(e.defaultBranch))},currentSelection:b||void 0,buttonText:b?.nameWithOwner||"Select repository",width:"medium",additionalButtonProps:{"aria-label":`Repository: ${b?.nameWithOwner||"Select repository"}`}}),k&&(b&&!_?(0,n.jsx)(u.PI,{cacheKey:"agent-sessions-ref-selector",canCreate:!1,currentCommitish:P,defaultBranch:b.defaultBranch,owner:b.owner,repo:b.nameOnly,types:["branch"],selectedRefType:"branch",closeOnSelect:!0,hideShowAll:!0,onSelectItem:e=>{A(e)}}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.f,{height:"32px",width:"100px"})})),$&&(0,n.jsx)(w,{apiURL:e,selectedAgent:O,onSelect:T,selectedRepo:b})]}),submitDisabled:!b||!P})}try{S.displayName||(S.displayName="NewTaskChatInput")}catch{}},97189:(e,t,r)=>{r.d(t,{Fn:()=>l,eS:()=>o});var n=r(74848),s=r(21728),a=r(96540);let i=(0,a.createContext)(void 0);function o(){let e=(0,a.useContext)(i);if(!e)throw Error("useConsecutiveCAPI401sContext must be used within a ConsecutiveCAPI401sProvider");return e}function l(e){let t,r,o,l,u,d=(0,s.c)(7),{children:h}=e,[p,f]=(0,a.useState)(0);return d[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>f(c),o=()=>f(0),d[0]=r,d[1]=o):(r=d[0],o=d[1]),d[2]!==p?(l={numberOf401s:p,increment401s:r,reset401s:o},d[2]=p,d[3]=l):l=d[3],t=l,d[4]!==h||d[5]!==t?(u=(0,n.jsx)(i.Provider,{value:t,children:h}),d[4]=h,d[5]=t,d[6]=u):u=d[6],u}function c(e){return e+1}try{i.displayName||(i.displayName="ConsecutiveCAPI401sContext")}catch{}try{l.displayName||(l.displayName="ConsecutiveCAPI401sProvider")}catch{}},42455:(e,t,r)=>{r.d(t,{b:()=>l});var n=r(97286),s=r(51120),a=r(97189),i=r(34295),o=r(96540);function l(...e){let t=(0,n.I)(...e),{numberOf401s:r,increment401s:c,reset401s:u}=(0,a.eS)(),{isError:d,isLoading:h,error:p}=t;return(0,o.useEffect)(()=>{d&&p instanceof s.j?c():d||h?r>5&&(new i.l().removeLocalStorageAuthToken(),u()):u()},[d,h,p,c,u,r]),t}},22337:(e,t,r)=>{r.d(t,{o:()=>a});var n=r(96540),s=r(96379);function a(){let[e,t]=(0,n.useState)(null);return(0,n.useEffect)(()=>{!async function(){if(!e)try{let e=await (0,s.lS)("/github-copilot/chat");if(!e.ok)throw Error(`Failed to fetch chat provider: ${e.statusText}`);let r=await e.json();t(r)}catch(e){console.error("Error fetching Copilot Chat provider:",e)}}()},[e]),e}},46642:(e,t,r)=>{r.d(t,{P:()=>u});var n=r(74848),s=r(96540),a=r(38621),i=r(1002),o=r(55847),l=r(70170),c=r(86391);function u({currentSelection:e,repositoryLoader:t,onSelect:r,selectionVariant:u,selectAllOption:d,additionalButtonProps:h,buttonText:p="",width:f}){let[b,m]=(0,s.useState)(""),[g,w]=(0,s.useState)([]),[y,S]=(0,s.useState)(!0),_=(0,s.useCallback)((0,l.s)(async e=>{try{let r=await t(e);w(r)}catch{}S(!1)},200),[t,w,S]);(0,s.useEffect)(()=>{S(!0),_(b)},[b,_,S]);let v=(0,s.useCallback)(e=>{"single"===u?!e[0]||e[0]._all?r(void 0):r(e[0]):r(e)},[u,r]),k=(0,s.useMemo)(()=>"multiple"===u?e||[]:e?[e]:[],[u,e]),x=(0,s.useCallback)(e=>{let t,r="medium"===f?35:24;return(e.name.length>r&&(t=`${e.name.substring(0,r)}...`),e._all)?{id:e.name,text:"All repositories",source:e,groupId:"all"}:{id:e.name,text:t||e.name,source:e,groupId:"select",disabled:!1===e.enabled,leadingVisual:()=>e.private?(0,n.jsx)(a.RepoLockedIcon,{size:16}):(0,n.jsx)(a.RepoIcon,{size:16})}},[f]),E=(0,s.useCallback)(e=>e.name,[]),P=(0,s.useMemo)(()=>{let e=[];return e.push(...k.filter(e=>g.every(t=>t.name!==e.name))||[]),e.push(...g),d&&e.push({name:"$all$",_all:!0}),e},[g,d,k]),A=p,I=a.RepoIcon;return A||("multiple"===u?A=k.length>0?`${k.length} repositor${k.length>1?"ies":"y"}`:"Select repositories":k.length>0&&k[0]?(A=k[0].name,I=k[0].private?a.RepoLockedIcon:a.RepoIcon):A=d?"All repositories":"Select a repository"),(0,n.jsx)(c.O,{renderAnchor:({"aria-labelledby":e,...t})=>(0,n.jsx)(o.Q,{leadingVisual:I,trailingAction:a.TriangleDownIcon,"aria-labelledby":` ${e}`,...t,...h,children:(0,n.jsx)(i.A,{title:A,maxWidth:195,children:A})}),placeholderText:"Search",items:P,loading:y,groups:d?[{groupId:"all"},{groupId:"select"}]:[],selectionVariant:u,initialSelectedItems:k,onSelectionChange:v,filterItems:m,getItemKey:E,convertToItemProps:x,title:"Select a repository",width:f})}try{u.displayName||(u.displayName="ReposSelector")}catch{}}}]);
//# sourceMappingURL=packages_relay-environment_relay-environment_ts-packages_agent-sessions_components_NewTaskCha-8c7997-b0b3c068ef5a.js.map